package funciones;

import model2.Envio;
import model2.EnvioRastreable;
import model2.EnvioRefrigerado;
import model2.EnvioUrgente;
import model2.EstadoEnvio;
import repositorio.RepositorioEnvios;

public class CentralEnvios {
	

	public void registrarEnvio(Envio envio) {

		RepositorioEnvios.insetEnvio(envio);
	}

	public void listarEnvios() {
		for (Envio e : RepositorioEnvios.findAll()) {
			System.out.println(e);
		}
	}

	public double costeTotal() {
		double suma = 0;

		for (Envio e : RepositorioEnvios.findAll()) {
			suma += e.calcularCoste();
		}
		return suma;
	}

	public double costeTotalSeguros() {
		double suma = 0;
		for (Envio e : RepositorioEnvios.findAll()) {
			if (e instanceof EnvioUrgente) {
				suma += ((EnvioUrgente) e).calcuralCosteSeguro();
			}
			if (e instanceof EnvioRefrigerado) {
				suma += ((EnvioRefrigerado) e).calcuralCosteSeguro();

			}
		}
		return suma;
	}

	public boolean actualizarEstado(int envio, EstadoEnvio nuevoEstado) {

		int posA = -1;
		boolean actualizar = false;

		for (int i = 0; i < RepositorioEnvios.findAll().length; i++) {
			if (RepositorioEnvios.findAll()[i].getCodigo() == envio) {
				posA = i;
			}
			
		}
		if (posA != -1) {
			((EnvioRastreable) RepositorioEnvios.findAll()[posA]).actualizarEstado(nuevoEstado);
			actualizar = true;
		}

		return actualizar;
	}

}
